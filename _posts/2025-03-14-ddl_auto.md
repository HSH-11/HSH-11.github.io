---
layout: single
title:  "JPAì˜ ddl-autoì˜ ì‚¬ìš©"
categories: Spring
tag: [JPA, Interview, BackEnd]
toc: true
toc_sticky: true
toc_label: ëª©ì°¨
author_profile: false
---


## JPAì˜ ddl-auto ì˜µì…˜ì€ ê°ê° ì–´ë–¤ ë™ì‘ì„ í•˜ê³  ì–´ë–¤ ìƒí™©ì—ì„œ ì‚¬ìš©í•´ì•¼ í• ê¹Œìš”?

ddl-auto ì˜µì…˜ì€ ìŠ¤í”„ë§ ë¶€íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ Hibernateì™€ ê°™ì€ JPA êµ¬í˜„ì²´ë¥¼ ì‚¬ìš©í•  ë•Œ DB ìŠ¤í‚¤ë§ˆ ê´€ë¦¬ë¥¼ ì œì–´í•˜ëŠ” ì„¤ì •ì…ë‹ˆë‹¤.

ì˜µì…˜ì€ `application.properties` ë˜ëŠ” `application.yml` íŒŒì¼ì—ì„œ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë©°, ë‹¤ì–‘í•œ ê°’ì— ë”°ë¼ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆì— ëŒ€í•´ ë‹¤ë¥¸ ë™ì‘ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ddl-auto ì˜µì…˜ì—ëŠ” none, validate, update, create, create-drop ë“±ì´ ì¡´ì¬í•©ë‹ˆë‹¤.

#### `application.properties` ë˜ëŠ” `application.yml`ì—ì„œ ì„¤ì •í•˜ê¸°

- application.properties

```properties
spring.datasource.url=jdbc:mysql://localhost:3306/mydatabase
spring.datasource.username=root
spring.datasource.password=1234
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect
spring.jpa.hibernate.ddl-auto=update
```

- application.yml

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/mydatabase
    username: root
    password: 1234
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    database-platform: org.hibernate.dialect.MySQL8Dialect
    hibernate:
      ddl-auto: update
```

#### Java ê¸°ë°˜ ì„¤ì •(@Configuration í´ë˜ìŠ¤ í™œìš©)

```java
@Configuration
public class JpaConfig {

    @Bean
    public LocalContainerEntityManagerFactoryBean entityManagerFactory(DataSource dataSource) {
        // Hibernateë¥¼ JPA êµ¬í˜„ì²´ë¡œ ì„¤ì •í•˜ì—¬ Spring Bootì˜ ìë™ ì„¤ì • ì—†ì´ ì§ì ‘ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•¨.
        LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();
        em.setDataSource(dataSource);
        
        // JPA ì—”í‹°í‹°ê°€ ìœ„ì¹˜í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì •í•˜ì—¬ ì—”í‹°í‹° ìë™ ê°ì§€
        em.setPackagesToScan("com.example.entity");

        JpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();
        em.setJpaVendorAdapter(vendorAdapter);

        Properties properties = new Properties();
        properties.setProperty("hibernate.hbm2ddl.auto", "update"); // ddl-auto ì„¤ì •
        properties.setProperty("hibernate.dialect", "org.hibernate.dialect.MySQL8Dialect");
        properties.setProperty("hibernate.show_sql", "true");

        em.setJpaProperties(properties);
        return em;
    }
}
```

ì´ ë°©ì‹ì€ `application.properties` ë˜ëŠ” `application.yml`ì„ í†µí•œ ì„¤ì •ë³´ë‹¤ ìš°ì„ ìˆœìœ„ê°€ ë†’ìŠµë‹ˆë‹¤.



### ê° ì˜µì…˜ì— ëŒ€í•œ ì„¤ëª…ì„ í•´ì£¼ì‹œê² ì–´ìš”? ğŸ¤”

- none: **DB ìŠ¤í‚¤ë§ˆì™€ ê´€ë ¨ëœ ì–´ë– í•œ ì‘ì—…ë„ ìˆ˜í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. ìŠ¤í‚¤ë§ˆë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ì‹¶ì„ ë•Œ ìœ ìš©í•˜ë©°, í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì£¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
- validate: ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹œì‘ë  ë•Œ, **ì—”í‹°í‹° ë§¤í•‘ì´ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì¦í•˜ë©° ìŠ¤í‚¤ë§ˆ ë³€ê²½ì€ ë”°ë¡œ ìˆ˜í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì—”í‹°í‹°ì™€ ìŠ¤í‚¤ë§ˆê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
- update: ì—”í‹°í‹° ë§¤í•‘ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ë¹„êµí•˜ì—¬ í•„ìš”í•œ ê²½ìš° ìŠ¤í‚¤ë§ˆë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. **ê¸°ì¡´ ë°ì´í„°ëŠ” ìœ ì§€ë˜ì§€ë§Œ, ìƒˆë¡œìš´ ì—”í‹°í‹°ë‚˜ ë³€ê²½ëœ ì—”í‹°í‹° í•„ë“œëŠ” ìŠ¤í‚¤ë§ˆì— ë°˜ì˜ë©ë‹ˆë‹¤**. í•´ë‹¹ ì˜µì…˜ì€ ì—”í‹°í‹°ì— ë³€ê²½ì´ ë°œìƒí•  ë•Œ ìë™ìœ¼ë¡œ ìŠ¤í‚¤ë§ˆë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ì‹¶ì„ ë•Œ ìœ ìš©í•©ë‹ˆë‹¤. í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ì˜ˆê¸°ì¹˜ ì•Šì€ ìŠ¤í‚¤ë§ˆ ë³€ê²½ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.
- create: **ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹œì‘ë  ë•Œ ê¸°ì¡´ ìŠ¤í‚¤ë§ˆë¥¼ ì‚­ì œí•˜ê³  ìƒˆë¡œ ìƒì„±í•©ë‹ˆë‹¤**. ë°ì´í„°ê°€ ëª¨ë‘ ì‚­ì œë˜ë©° ì—”í‹°í‹° ë§¤í•‘ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ ìŠ¤í‚¤ë§ˆê°€ê°€ ìƒì„±ë©ë‹ˆë‹¤. ê°œë°œ ì´ˆê¸°ì— ë¹ˆ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ë°˜ë³µì ìœ¼ë¡œ ìƒì„±í•´ì•¼ í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤. ê¸°ì¡´ ë°ì´í„°ê°€ ëª¨ë‘ ì‚­ì œë˜ë¯€ë¡œ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- create-drop: createì™€ ìœ ì‚¬í•˜ì§€ë§Œ, **ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¢…ë£Œë  ë•Œ ìŠ¤í‚¤ë§ˆë¥¼ ì‚­ì œí•œë‹¤ëŠ” ì ì´ ë‹¤ë¦…ë‹ˆë‹¤**. í•´ë‹¹ ì˜µì…˜ì€ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì¼ì‹œì ì¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆê°€ í•„ìš”í•œ ê²½ìš° ìœ ìš©í•˜ë©°, ë§¤ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œë§ˆë‹¤ ê¹¨ë—í•œ ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœë¥¼ ìœ ì§€í•˜ê³ ì í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ìŠ¤í‚¤ë§ˆ ë³€ê²½ì€ ì–´ë–»ê²Œ í•´ì•¼í•˜ë‚˜ìš”? ğŸ¤“

ìŠ¤í‚¤ë§ˆ ë³€ê²½ì´ í•„ìš”í•  ë•ŒëŠ” ì ì ˆí•œ ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ë„êµ¬(Flyway, Liquibase ë“±)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì œì–´ëœ ë°©ì‹ìœ¼ë¡œ ìŠ¤í‚¤ë§ˆë¥¼ ê´€ë¦¬í•˜ê±°ë‚˜, ì‚¬ìš©ìê°€ ì—†ëŠ” ìƒˆë²½ì— ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‘ì—…ì„ ìˆ˜ë™ìœ¼ë¡œ ì§„í–‰í•˜ëŠ” ê²ƒì´ ë”ìš± ì•ˆì „í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
